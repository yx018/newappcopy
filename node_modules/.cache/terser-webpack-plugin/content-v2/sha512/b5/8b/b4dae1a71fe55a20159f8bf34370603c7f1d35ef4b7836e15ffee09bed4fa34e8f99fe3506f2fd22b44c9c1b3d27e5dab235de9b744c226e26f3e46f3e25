{"code":"(this.webpackJsonpnewappcopy=this.webpackJsonpnewappcopy||[]).push([[0],{28:function(e,t,n){},29:function(e,t,n){},33:function(e,t,n){},54:function(e,t,n){\"use strict\";n.r(t);var o=n(1),a=n(22),i=n.n(a),s=(n(28),n(29),n(9)),c=n(8),r=n.n(c),d=n(12),l=n(23),u=n(3);n(33);var h=function(e){console.log(\"utils:\",e);var t=this;this.createFileFromUrl=function(n,o,a){var i=new XMLHttpRequest;i.open(\"GET\",o,!0),i.responseType=\"arraybuffer\",i.onload=function(s){if(4===i.readyState){if(200!==i.status)return void t.printError(\"Failed to load \"+o+\" status: \"+i.status);var c=new Uint8Array(i.response);e.FS_createDataFile(\"/\",n,c,!0,!1,!1),a()}},i.send()};var n=\"./opencv/opencv.js\";this.loadOpenCv=function(o){var a=document.createElement(\"script\");a.setAttribute(\"async\",\"\"),a.setAttribute(\"type\",\"text/javascript\"),a.addEventListener(\"load\",Object(d.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.getBuildInformation){t.next=5;break}console.log(e.getBuildInformation()),o(),t.next=14;break;case 5:if(!(e instanceof Promise)){t.next=13;break}return t.next=8,e;case 8:e=t.sent,console.log(e.getBuildInformation()),o(),t.next=14;break;case 13:e.onRuntimeInitialized=function(){console.log(e.getBuildInformation()),o()};case 14:case\"end\":return t.stop()}}),t)})))),a.addEventListener(\"error\",(function(){t.printError(\"Failed to load \"+n)})),a.src=n;var i=document.getElementsByTagName(\"script\")[0];i.parentNode.insertBefore(a,i)}},p=(n(34),n(0));var m=function(){var e=Object(u.b)(),t=e.loaded,n=e.cv,a=Object(o.useState)(!1),i=Object(l.a)(a,2),s=i[0],c=i[1];return Object(o.useEffect)((function(){console.log(t,n),t&&(console.log(\"component cv loaded\"),s&&(console.log(\"video loaded\"),function(){console.log(\"opencvReady\",n.Mat,t);var e=new h(n),o=.25,a=document.getElementById(\"cam_input\"),i=new n.Mat(a.height,a.width,n.CV_8UC4),s=new n.Mat(a.height,a.width,n.CV_8UC1),c=new n.Mat,r=new n.VideoCapture(a),d=new n.RectVector,l=new n.CascadeClassifier,u=(new n.Size(0,0),new n.Size(1e3,1e3),\"haarcascade_frontalface_default.xml\"),p=a.width/5,m=a.height/5;function b(){var e=document.createElement(\"canvas\");return e.width=.5*a.width,e.height=.5*a.height,e.getContext(\"2d\").drawImage(a,0,0,e.width,e.height),e.toDataURL(\"image/ipeg\").split(\";base64,\")[1]}function j(){var e=Date.now();if(null!=a.srcObject){r.read(i),i.copyTo(s),n.cvtColor(s,c,n.COLOR_RGBA2GRAY,0);var t=b(),u=new FormData;u.append(\"api_key\",\"ZK0tSZ-34wMRkeWaCivkN4Ty5MFV4a9j\"),u.append(\"api_secret\",\"Kqt6dM83UsEoudBS0egUgYPIt_WOFFhQ\"),u.append(\"image_base64\",t);try{l.detectMultiScale(c,d,1.1,3)}catch(_){console.log(_)}for(var h=0;h<d.size();++h){var g=d.get(h),f=parseInt(g.y/m),v=parseInt(g.x/p),w=parseInt((g.y+g.height-5)/m),x=parseInt((g.x+g.width-5)/p);if(!(g.width>=p||g.height>=m||w!=f||x!=v)){var y=new n.Point(g.x,g.y),O=new n.Point(g.x+g.width,g.y+g.height);n.rectangle(s,y,O,[255,0,0,255])}}n.imshow(\"canvas_output\",s)}var E=1e3/o-(Date.now()-e);setTimeout(j,E)}console.log(\"cvReady classifier\",l),console.log(\"here\"),e.createFileFromUrl(u,u,(function(){l.load(u)})),setTimeout(j,0)}()))}),[t,s]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)(\"div\",{className:\"container\",children:[Object(p.jsx)(\"h2\",{id:\"title\",children:\"iExam\"}),Object(p.jsx)(\"h6\",{id:\"tip\",children:\"Please click add button to import the Zoom stream. Then you can scroll down to the iExam window.\"}),Object(p.jsx)(\"p\",{id:\"zoom_window_text\",children:\"Zoom window\"}),Object(p.jsx)(\"video\",{id:\"cam_input\",width:\"1200\",height:\"690\",autoPlay:!0,muted:!0}),Object(p.jsx)(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",id:\"add\",onClick:function(){navigator.mediaDevices.getDisplayMedia({video:!0,audio:!1}).then((function(e){var t=document.getElementById(\"cam_input\"),n=document.getElementById(\"add\"),o=document.getElementById(\"zoom_window_text\"),a=document.getElementById(\"process_window_text\"),i=document.getElementById(\"canvas_output\");t.srcObject=e,console.log(e);var s=e.getVideoTracks()[0].getSettings();console.log(s),n.style.display=\"none\",o.style.display=\"none\",a.style.display=\"none\",i.style.width=t.style.width,i.style.height=t.style.height,t.play()})).then((function(){c(!0)})).catch((function(e){console.log(\"An error occurred! \"+e)}))},width:\"120\",height:\"120\",viewBox:\"0 0 24 24\",children:Object(p.jsx)(\"path\",{d:\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z\"})}),Object(p.jsx)(\"p\",{id:\"process_window_text\",children:\"iExam window\"}),Object(p.jsx)(\"canvas\",{id:\"canvas_output\",width:\"1200\",height:\"690\",children:\"This box is for capturing student face\"})]}),Object(p.jsxs)(\"div\",{className:\"footer\",children:[Object(p.jsxs)(\"p\",{children:[\"Details for iExam please refer to slides: \",Object(p.jsx)(\"a\",{href:\"https://daoyuan14.github.io/slides/Expo21_iExam.pdf\",target:\"_blank\",children:\"https://daoyuan14.github.io/slides/Expo21_iExam.pdf\"})]}),Object(p.jsxs)(\"p\",{children:[\"Post-exam recording analysis for desktop version, please view: \",Object(p.jsx)(\"a\",{href:\"https://github.com/VPRLab/iExam/tree/test\",target:\"_blank\",children:\"https://github.com/VPRLab/iExam/tree/test \"})]})]})]})},b=n(4),j=n(5),g=n(7),f=n(6),v=function(e){Object(g.a)(n,e);var t=Object(f.a)(n);function n(e){var o;return Object(b.a)(this,n),(o=t.call(this,e)).state={zone:{name:\"\",zipCode:\"\"}},o}return Object(j.a)(n,[{key:\"updateZone\",value:function(e){var t=Object.assign({},this.state.zone);t[e.target.id]=e.target.value,this.setState({zone:t})}},{key:\"submitZone\",value:function(e){console.log(\"SubmitZone: \"+JSON.stringify(this.state.zone)),this.props.onCreate(this.state.zone)}},{key:\"render\",value:function(){return Object(p.jsxs)(\"div\",{children:[Object(p.jsx)(\"input\",{onChange:this.updateZone.bind(this),className:\"form-control\",id:\"name\",type:\"text\",placeholder:\"Name\"}),\" \",Object(p.jsx)(\"br\",{}),Object(p.jsx)(\"input\",{onChange:this.updateZone.bind(this),className:\"form-control\",id:\"zipCode\",type:\"text\",placeholder:\"Zip Code\"}),\" \",Object(p.jsx)(\"br\",{}),Object(p.jsx)(\"input\",{onClick:this.submitZone.bind(this),className:\"btn btn-danger\",type:\"submit\",value:\"Submit Zone\"})]})}}]),n}(o.Component),w=function(e){Object(g.a)(n,e);var t=Object(f.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(j.a)(n,[{key:\"render\",value:function(){return Object(p.jsxs)(\"div\",{children:[Object(p.jsx)(\"h2\",{children:Object(p.jsxs)(\"a\",{href:\"#\",children:[\" \",this.props.currentZone.name,\" \"]})}),Object(p.jsxs)(\"span\",{className:\"detail\",children:[\" \",this.props.currentZone.zipCodes,\" \"]}),\" \",Object(p.jsx)(\"br\",{}),Object(p.jsxs)(\"span\",{className:\"detail\",children:[\" \",this.props.currentZone.numComments,\" comments\",\" \"]})]})}}]),n}(o.Component);o.Component;function x(){var e=Object(u.b)(),t=e.loaded,n=e.cv,a=document.getElementById(\"status\");return Object(o.useEffect)((function(){console.log(t,n),console.log(window.cv),t&&(a.style.display=\"none\")}),[t]),t?Object(p.jsx)(m,{}):Object(p.jsx)(\"p\",{id:\"status\",style:{fontSize:20},children:\"OpenCV.js is loading...\"})}var y=function(){Object(o.useEffect)((function(){if(console.log(\"\".concat(s.browserName,\" \").concat(s.browserVersion)),console.log(typeof s.browserName),console.log(s.browserName),\"Safari\"==s.browserName)for(console.log(\"yes\");;)alert(\"You use Safari now, please change another browser because Safari not support capture window function\")}));return Object(p.jsx)(\"div\",{children:Object(p.jsx)(u.a,{children:Object(p.jsx)(x,{})})})};i.a.render(Object(p.jsx)(y,{}),document.getElementById(\"root\"))}},[[54,1,2]]]);","name":"static/js/main.8c9ee065.chunk.js","map":{"version":3,"sources":["static/js/main.8c9ee065.chunk.js"],"names":["this","push","module","exports","__webpack_require__","__webpack_exports__","r","react","react_dom","react_dom_default","n","lib","regenerator","regenerator_default","asyncToGenerator","slicedToArray","index_modern","src_Utils","cv","console","log","self","createFileFromUrl","path","url","callback","request","XMLHttpRequest","open","responseType","onload","ev","readyState","status","printError","data","Uint8Array","response","FS_createDataFile","send","OPENCV_URL","loadOpenCv","onloadCallback","script","document","createElement","setAttribute","addEventListener","Object","a","mark","_callee","wrap","_context","prev","next","getBuildInformation","Promise","sent","stop","src","node","getElementsByTagName","parentNode","insertBefore","jsx_runtime","src_MyComponent","_useOpenCv","loaded","_useState","_useState2","videoLoaded","setVideoLoaded","Mat","utils","FPS","video","getElementById","height","width","CV_8UC4","dst","CV_8UC1","gray","cap","VideoCapture","faces","RectVector","classifier","CascadeClassifier","faceCascadeFile","Size","clip_width","clip_height","captureImageFromVideo","canvas","getContext","drawImage","toDataURL","split","processVideo","begin","Date","now","srcObject","read","copyTo","cvtColor","COLOR_RGBA2GRAY","post_img","formData","FormData","append","detectMultiScale","err","i","size","face","get","face_row","parseInt","y","face_col","x","tmp_row","tmp_col","point1","Point","point2","rectangle","imshow","delay","setTimeout","load","openCvReady","children","className","id","autoPlay","muted","xmlns","onClick","navigator","mediaDevices","getDisplayMedia","audio","then","stream","add_button","zoom_window_text","process_window_text","output","settings","getVideoTracks","getSettings","style","display","play","catch","viewBox","d","href","target","classCallCheck","createClass","inherits","createSuper","CreateZone_CreateZone","_Component","CreateZone","_super","props","_this","call","state","zone","name","zipCode","key","value","event","updated","assign","setState","JSON","stringify","onCreate","onChange","updateZone","bind","type","placeholder","submitZone","Zone_Zone","Zone","apply","arguments","currentZone","zipCodes","numComments","LoadOpenCv","cv_status","window","fontSize","src_App_0","concat","alert","render"],"mappings":"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"},"input":"(this[\"webpackJsonpnewappcopy\"] = this[\"webpackJsonpnewappcopy\"] || []).push([[0],{\n\n/***/ 28:\n/***/ (function(module, exports, __webpack_require__) {\n\n// extracted by mini-css-extract-plugin\n\n/***/ }),\n\n/***/ 29:\n/***/ (function(module, exports, __webpack_require__) {\n\n// extracted by mini-css-extract-plugin\n\n/***/ }),\n\n/***/ 33:\n/***/ (function(module, exports, __webpack_require__) {\n\n// extracted by mini-css-extract-plugin\n\n/***/ }),\n\n/***/ 54:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXTERNAL MODULE: ./node_modules/react/index.js\nvar react = __webpack_require__(1);\n\n// EXTERNAL MODULE: ./node_modules/react-dom/index.js\nvar react_dom = __webpack_require__(22);\nvar react_dom_default = /*#__PURE__*/__webpack_require__.n(react_dom);\n\n// EXTERNAL MODULE: ./src/index.css\nvar src_0 = __webpack_require__(28);\n\n// EXTERNAL MODULE: ./src/App.css\nvar src_App = __webpack_require__(29);\n\n// EXTERNAL MODULE: ./node_modules/react-device-detect/dist/lib.js\nvar lib = __webpack_require__(9);\n\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator/index.js\nvar regenerator = __webpack_require__(8);\nvar regenerator_default = /*#__PURE__*/__webpack_require__.n(regenerator);\n\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\nvar asyncToGenerator = __webpack_require__(12);\n\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js + 5 modules\nvar slicedToArray = __webpack_require__(23);\n\n// EXTERNAL MODULE: ./node_modules/opencv-react/dist/index.modern.js\nvar index_modern = __webpack_require__(3);\n\n// EXTERNAL MODULE: ./src/MyComponent.css\nvar MyComponent = __webpack_require__(33);\n\n// CONCATENATED MODULE: ./src/Utils.js\nfunction Utils(cv){// const { loaded, cv } = useOpenCv();\n// useEffect(() => {\n//     if (cv) {\n//         console.log('utils useEffect', cv);\n//     }\n// }, [cv])\nconsole.log('utils:',cv);var self=this;this.createFileFromUrl=function(path,url,callback){var request=new XMLHttpRequest();request.open('GET',url,true);request.responseType='arraybuffer';request.onload=function(ev){if(request.readyState===4){if(request.status===200){var data=new Uint8Array(request.response);cv.FS_createDataFile('/',path,data,true,false,false);callback();}else{self.printError('Failed to load '+url+' status: '+request.status);return;}}};request.send();};var OPENCV_URL='./opencv/opencv.js';this.loadOpenCv=function(onloadCallback){var script=document.createElement('script');script.setAttribute('async','');script.setAttribute('type','text/javascript');script.addEventListener('load',/*#__PURE__*/Object(asyncToGenerator[\"a\" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(){return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!cv.getBuildInformation){_context.next=5;break;}console.log(cv.getBuildInformation());onloadCallback();_context.next=14;break;case 5:if(!(cv instanceof Promise)){_context.next=13;break;}_context.next=8;return cv;case 8:cv=_context.sent;console.log(cv.getBuildInformation());onloadCallback();_context.next=14;break;case 13:cv['onRuntimeInitialized']=function(){console.log(cv.getBuildInformation());onloadCallback();};case 14:case\"end\":return _context.stop();}}},_callee);})));script.addEventListener('error',function(){self.printError('Failed to load '+OPENCV_URL);});script.src=OPENCV_URL;var node=document.getElementsByTagName('script')[0];node.parentNode.insertBefore(script,node);};}/* harmony default export */ var src_Utils = (Utils);\n// EXTERNAL MODULE: ./node_modules/axios/index.js\nvar axios = __webpack_require__(34);\n\n// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js\nvar jsx_runtime = __webpack_require__(0);\n\n// CONCATENATED MODULE: ./src/MyComponent.js\nfunction MyComponent_MyComponent(){var _useOpenCv=Object(index_modern[\"b\" /* useOpenCv */])(),loaded=_useOpenCv.loaded,cv=_useOpenCv.cv;var _useState=Object(react[\"useState\"])(false),_useState2=Object(slicedToArray[\"a\" /* default */])(_useState,2),videoLoaded=_useState2[0],setVideoLoaded=_useState2[1];Object(react[\"useEffect\"])(function(){console.log(loaded,cv);if(loaded){console.log('component cv loaded');if(videoLoaded){console.log('video loaded');openCvReady();}}},[loaded,videoLoaded]);// const [count, setCount] = useState(0);\nvar catchZoomWindow=function catchZoomWindow(){navigator.mediaDevices.getDisplayMedia({video:true,audio:false}).then(function(stream){var video=document.getElementById(\"cam_input\");var add_button=document.getElementById(\"add\");var zoom_window_text=document.getElementById(\"zoom_window_text\");var process_window_text=document.getElementById(\"process_window_text\");var output=document.getElementById(\"canvas_output\");// console.log(video);\n// console.log(stream);\nvideo.srcObject=stream;console.log(stream);var settings=stream.getVideoTracks()[0].getSettings();console.log(settings);add_button.style.display=\"none\";zoom_window_text.style.display=\"none\";process_window_text.style.display=\"none\";// FPS = settings.frameRate;\noutput.style.width=video.style.width;output.style.height=video.style.height;video.play();}).then(function(){// openCvReady();\n// utils.loadOpenCv(openCvReady);\nsetVideoLoaded(true);}).catch(function(err){console.log(\"An error occurred! \"+err);});};function openCvReady(){// const { loaded, cv } = useOpenCv();\nconsole.log('opencvReady',cv.Mat,loaded);var utils=new src_Utils(cv);var FPS=0.25;var video=document.getElementById(\"cam_input\");var src=new cv.Mat(video.height,video.width,cv.CV_8UC4);var dst=new cv.Mat(video.height,video.width,cv.CV_8UC1);var gray=new cv.Mat();var cap=new cv.VideoCapture(video);var faces=new cv.RectVector();var classifier=new cv.CascadeClassifier();var minsize=new cv.Size(0,0);var maxsize=new cv.Size(1000,1000);var faceCascadeFile=\"haarcascade_frontalface_default.xml\";var clip_width=video.width/5;var clip_height=video.height/5;console.log('cvReady classifier',classifier);console.log('here');utils.createFileFromUrl(faceCascadeFile,faceCascadeFile,function(){classifier.load(faceCascadeFile);});// utils.createFileFromUrl(faceCascadeFile, faceCascadeFile, () => {\n//     console.log('here2');\n//     classifier.load(faceCascadeFile) // in the callback, load the cascade from file\n//     .then(()=>{\n//         console.log('AAA'); \n//         processVideo();\n//     })\n//     .catch((err)=>{console.log('load classifier:', err)});\n// });\n// let face_row = -1;\n// let face_col = -1;\n// while(true){\n//     let begin = Date.now();\n//     cap.read(src);\n//     src.copyTo(dst);\n//     cv.cvtColor(dst, gray, cv.COLOR_RGBA2GRAY, 0);\n//     console.log('process classifier:', classifier);\n//     // console.log(classifier.load);\n//     // console.log(gray);\n//     // console.log(faces);\n//     try{\n//         classifier.detectMultiScale(gray, faces, 1.1, 3);\n//     }catch(err){\n//         console.log(err);\n//     }\n// }\nfunction captureImageFromVideo(){var canvas=document.createElement('canvas');canvas.width=video.width*0.5;canvas.height=video.height*0.5;canvas.getContext(\"2d\").drawImage(video,0,0,canvas.width,canvas.height);// var img = document.createElement('img');\nvar base64Canvas=canvas.toDataURL('image/ipeg').split(';base64,')[1];return base64Canvas;}function getFaceFromFaceplusplus(){return _getFaceFromFaceplusplus.apply(this,arguments);}function _getFaceFromFaceplusplus(){_getFaceFromFaceplusplus=Object(asyncToGenerator[\"a\" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(){var post_img,formData,response,data;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:post_img=captureImageFromVideo();formData=new FormData();formData.append('api_key','ZK0tSZ-34wMRkeWaCivkN4Ty5MFV4a9j');formData.append('api_secret','Kqt6dM83UsEoudBS0egUgYPIt_WOFFhQ');formData.append('image_base64',post_img);_context.next=7;return fetch('https://api-cn.faceplusplus.com/facepp/v3/detect',{method:'post',mode:'no-cors',body:formData});case 7:response=_context.sent;// let data = await JSON.parse({\"request_id\": \"1636947607,16ad0124-2bfb-436d-9636-de57d16e23c9\",\"time_used\": 519});\n// let tmp_response ='{\"request_id\": \"1636947607,16ad0124-2bfb-436d-9636-de57d16e23c9\",\"time_used\": 519}';\ndata=response.json();return _context.abrupt(\"return\",data);case 10:case\"end\":return _context.stop();}}},_callee);}));return _getFaceFromFaceplusplus.apply(this,arguments);}function processVideo(){var begin=Date.now();if(video.srcObject!=null){cap.read(src);src.copyTo(dst);cv.cvtColor(dst,gray,cv.COLOR_RGBA2GRAY,0);// console.log('process classifier:', classifier);\nvar post_img=captureImageFromVideo();var formData=new FormData();formData.append('api_key','ZK0tSZ-34wMRkeWaCivkN4Ty5MFV4a9j');formData.append('api_secret','Kqt6dM83UsEoudBS0egUgYPIt_WOFFhQ');formData.append('image_base64',post_img);// console.log(post_img);\n// axios.post('https://api-cn.faceplusplus.com/facepp/v3/detect', {\n//     // headers: {\n//     //     'Access-Control-Allow-Origin': '*',\n//     // },\n//     mode: 'no-cors',\n//     body: formData\n// }).then(function (response) {\n//     console.log(response);\n// })\n// .catch(function (error) {\n// console.log(error);\n// });\n// fetch('https://api-cn.faceplusplus.com/facepp/v3/detect', {\n//     method: 'post',\n//     mode: 'no-cors',\n//     body: formData\n// })\n// // .then(res => res.json())\n// .then(res => {\n//     console.log(typeof(res));\n//     console.log(res);\n//     console.log(res.json());\n// })\n// .catch(function(err) {\n//     console.log('fetch err:', err);\n// });\n// let data = getFaceFromFaceplusplus();\n// console.log('data:', data);\n// var http = new XMLHttpRequest();\n// var url = 'https://api-cn.faceplusplus.com/facepp/v3/detect';\n// http.open('POST', url, true);\n// http.setRequestHeader('Access-Control-Allow-Origin','*');\n// http.onload = function() {//Call a function when the state changes.\n//     if(http.readyState == 4 && http.status == 200) {\n//         console.log(http.responseText);\n//     }\n//     else {\n//         console.log('Failed to load ' + url + ' status: ' + http.status);\n//     }\n// }\n// http.send(formData);\n// error Message location\n// classifier.detectMultiScale(gray, faces, 1.1, 3);\ntry{classifier.detectMultiScale(gray,faces,1.1,3);}catch(err){console.log(err);}for(var i=0;i<faces.size();++i){var face=faces.get(i);// console.log(face);\nvar face_row=parseInt(face.y/clip_height);var face_col=parseInt(face.x/clip_width);var tmp_row=parseInt((face.y+face.height-5)/clip_height);var tmp_col=parseInt((face.x+face.width-5)/clip_width);// console.log([face_row, face_col, tmp_row, tmp_col]);\nif(face.width>=clip_width||face.height>=clip_height||tmp_row!=face_row||tmp_col!=face_col)continue;var point1=new cv.Point(face.x,face.y);var point2=new cv.Point(face.x+face.width,face.y+face.height);cv.rectangle(dst,point1,point2,[255,0,0,255]);}cv.imshow(\"canvas_output\",dst);}// schedule next one.\nvar delay=1000/FPS-(Date.now()-begin);setTimeout(processVideo,delay);}// schedule first one.\nsetTimeout(processVideo,0);}// const cv = useOpenCv()\n// console.log(cv)\n// const video = document.getElementById(\"video\");\n// let src = new cv.Mat(video.height, video.width, cv.CV_8UC4);\n// let dst = new cv.Mat(video.height, video.width, cv.CV_8UC1);\n// let gray = new cv.Mat();\n// let cap = new cv.VideoCapture(video);\n// let faces = new cv.RectVector();\n// let classifier = new cv.CascadeClassifier();\n// let faceCascadeFile = 'haarcascade_frontalface_default.xml'; // path to xml\n// classifier.load(faceCascadeFile);\n// console.log(classifier);\n// function onOpenUtilsReady() {\n//     let utils = new Utils('errorMessage');\n//     utils.loadOpenCv(() => {\n//     let faceCascadeFile = 'haarcascade_frontalface_default.xml';\n//         utils.createFileFromUrl(faceCascadeFile, faceCascadeFile, () => {\n//             document.getElementById('status').innerHTML = 'OpenCV.js is ready.';\n//         });\n//     });\n// }\nreturn/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(jsx_runtime[\"Fragment\"],{children:[/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"container\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"h2\",{id:\"title\",children:\"iExam\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"h6\",{id:\"tip\",children:\"Please click add button to import the Zoom stream. Then you can scroll down to the iExam window.\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"p\",{id:\"zoom_window_text\",children:\"Zoom window\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"video\",{id:\"cam_input\",width:\"1200\",height:\"690\",autoPlay:true,muted:true}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",id:\"add\",onClick:catchZoomWindow,width:\"120\",height:\"120\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"path\",{d:\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z\"})}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"p\",{id:\"process_window_text\",children:\"iExam window\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"canvas\",{id:\"canvas_output\",width:\"1200\",height:\"690\",children:\"This box is for capturing student face\"})]}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"footer\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"p\",{children:[\"Details for iExam please refer to slides: \",/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"a\",{href:\"https://daoyuan14.github.io/slides/Expo21_iExam.pdf\",target:\"_blank\",children:\"https://daoyuan14.github.io/slides/Expo21_iExam.pdf\"})]}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"p\",{children:[\"Post-exam recording analysis for desktop version, please view: \",/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"a\",{href:\"https://github.com/VPRLab/iExam/tree/test\",target:\"_blank\",children:\"https://github.com/VPRLab/iExam/tree/test \"})]})]})]});}// function Utils() {\n//     let self = this;\n//     this.createFileFromUrl = function(path, url, callback) {\n//         console.log(cv);\n//         let request = new XMLHttpRequest();\n//         request.open('GET', url, true);\n//         request.responseType = 'arraybuffer';\n//         request.onload = function(ev) {\n//             if (request.readyState === 4) {\n//                 if (request.status === 200) {\n//                     let data = new Uint8Array(request.response);\n//                     cv.FS_createDataFile('/', path, data, true, false, false);\n//                     callback();\n//                 } else {\n//                     self.printError('Failed to load ' + url + ' status: ' + request.status);\n//                 }\n//             }\n//         };\n//         request.send();\n//     };\n//     const OPENCV_URL = './opencv/opencv.js';\n//     this.loadOpenCv = function(onloadCallback) {\n//         let script = document.createElement('script');\n//         script.setAttribute('async', '');\n//         script.setAttribute('type', 'text/javascript');\n//         script.addEventListener('load', async () => {\n//             if (cv.getBuildInformation)\n//             {\n//                 console.log(cv.getBuildInformation());\n//                 onloadCallback();\n//             }\n//             else\n//             {\n//                 // WASM\n//                 if (cv instanceof Promise) {\n//                     cv = await cv;\n//                     console.log(cv.getBuildInformation());\n//                     onloadCallback();\n//                 } else {\n//                     cv['onRuntimeInitialized']=()=>{  //satisfy this condition\n//                         console.log(cv.getBuildInformation()); \n//                         onloadCallback();\n//                     }\n//                 }\n//             }\n//         });\n//         script.addEventListener('error', () => {\n//             self.printError('Failed to load ' + OPENCV_URL);\n//         });\n//         script.src = OPENCV_URL;\n//         let node = document.getElementsByTagName('script')[0];\n//         node.parentNode.insertBefore(script, node);\n//     };\n// }\n/* harmony default export */ var src_MyComponent = (MyComponent_MyComponent);\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\nvar classCallCheck = __webpack_require__(4);\n\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass.js\nvar createClass = __webpack_require__(5);\n\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits.js + 1 modules\nvar inherits = __webpack_require__(7);\n\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper.js + 5 modules\nvar createSuper = __webpack_require__(6);\n\n// CONCATENATED MODULE: ./src/test/CreateZone.js\nvar CreateZone_CreateZone=/*#__PURE__*/function(_Component){Object(inherits[\"a\" /* default */])(CreateZone,_Component);var _super=Object(createSuper[\"a\" /* default */])(CreateZone);function CreateZone(props){var _this;Object(classCallCheck[\"a\" /* default */])(this,CreateZone);_this=_super.call(this,props);_this.state={zone:{name:\"\",zipCode:\"\"}};return _this;}Object(createClass[\"a\" /* default */])(CreateZone,[{key:\"updateZone\",value:function updateZone(event){var updated=Object.assign({},this.state.zone);updated[event.target.id]=event.target.value;this.setState({zone:updated});}},{key:\"submitZone\",value:function submitZone(event){console.log(\"SubmitZone: \"+JSON.stringify(this.state.zone));this.props.onCreate(this.state.zone);}},{key:\"render\",value:function render(){return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"input\",{onChange:this.updateZone.bind(this),className:\"form-control\",id:\"name\",type:\"text\",placeholder:\"Name\"}),\" \",/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"br\",{}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"input\",{onChange:this.updateZone.bind(this),className:\"form-control\",id:\"zipCode\",type:\"text\",placeholder:\"Zip Code\"}),\" \",/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"br\",{}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"input\",{onClick:this.submitZone.bind(this),className:\"btn btn-danger\",type:\"submit\",value:\"Submit Zone\"})]});}}]);return CreateZone;}(react[\"Component\"]);\n// CONCATENATED MODULE: ./src/test/Zone.js\nvar Zone_Zone=/*#__PURE__*/function(_Component){Object(inherits[\"a\" /* default */])(Zone,_Component);var _super=Object(createSuper[\"a\" /* default */])(Zone);function Zone(){Object(classCallCheck[\"a\" /* default */])(this,Zone);return _super.apply(this,arguments);}Object(createClass[\"a\" /* default */])(Zone,[{key:\"render\",value:function render(){return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"h2\",{children:/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"a\",{href:\"#\",children:[\" \",this.props.currentZone.name,\" \"]})}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"span\",{className:\"detail\",children:[\" \",this.props.currentZone.zipCodes,\" \"]}),\" \",/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"br\",{}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"span\",{className:\"detail\",children:[\" \",this.props.currentZone.numComments,\" comments\",\" \"]})]});}}]);return Zone;}(react[\"Component\"]);\n// CONCATENATED MODULE: ./src/test/Zones.js\n// import superagent from \"superagent\";\nvar Zones_Zones=/*#__PURE__*/function(_Component){Object(inherits[\"a\" /* default */])(Zones,_Component);var _super=Object(createSuper[\"a\" /* default */])(Zones);function Zones(props){var _this;Object(classCallCheck[\"a\" /* default */])(this,Zones);_this=_super.call(this,props);_this.state={list:[]};return _this;}Object(createClass[\"a\" /* default */])(Zones,[{key:\"componentDidMount\",value:function componentDidMount(){console.log(\"componentDidMount\");// superagent\n//   .get(\"/api/zone\")\n//   .query(null)\n//   .set(\"Accept\", \"application/json\")\n//   .end((err, response) => {\n//     if (err) {\n//       alert(\"ERROR: \" + err);\n//       return;\n//     }\n//     console.log(JSON.stringify(response.body));\n//     let results = response.body.results;\n//     this.setState({\n//       list: results,\n//     });\n//   });\n}},{key:\"addZone\",value:function addZone(zone){var updatedZone=Object.assign({},zone);updatedZone[\"zipCodes\"]=updatedZone.zipCode.split(\",\");console.log(\"ADD ZONE: \"+JSON.stringify(updatedZone));// superagent\n//   .post(\"/api/zone\")\n//   .send(updatedZone)\n//   .set(\"Accept\", \"application/json\")\n//   .end((err, response) => {\n//     if (err) {\n//       alert(\"ERROR: \" + err.message);\n//       return;\n//     }\n//     console.log(\"ZONE CREATED: \" + JSON.stringify(response));\n//     let updatedList = Object.assign([], this.state.list);\n//     updatedList.push(response.result);\n//     this.setState({\n//       list: updatedList,\n//     });\n//   });\n}},{key:\"render\",value:function render(){var listItems=this.state.list.map(function(zone,i){return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"li\",{children:[\" \",/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Zone_Zone,{currentZone:zone}),\" \"]},i);});return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"ol\",{children:listItems}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(CreateZone_CreateZone,{onCreate:this.addZone.bind(this)})]});}}]);return Zones;}(react[\"Component\"]);\n// CONCATENATED MODULE: ./src/App.js\n// import Utils from './Utils';\nfunction LoadOpenCv(){var _useOpenCv=Object(index_modern[\"b\" /* useOpenCv */])(),loaded=_useOpenCv.loaded,cv=_useOpenCv.cv;var cv_status=document.getElementById(\"status\");Object(react[\"useEffect\"])(function(){console.log(loaded,cv);console.log(window.cv);if(loaded){cv_status.style.display=\"none\";}},[loaded]);if(loaded)return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(src_MyComponent,{});else return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"p\",{id:\"status\",style:({display:'block'},{fontSize:20}),children:\"OpenCV.js is loading...\"});}var App_App=function App(){Object(react[\"useEffect\"])(function(){console.log(\"\".concat(lib[\"browserName\"],\" \").concat(lib[\"browserVersion\"]));console.log(typeof lib[\"browserName\"]);console.log(lib[\"browserName\"]);if(lib[\"browserName\"]=='Safari'){console.log(\"yes\");while(true){alert(\"You use Safari now, please change another browser because Safari not support capture window function\");}}});var onLoaded=function onLoaded(){console.log('opencv loaded, cv');};return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(index_modern[\"a\" /* OpenCvProvider */],{children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(LoadOpenCv,{})})});};/* harmony default export */ var src_App_0 = (App_App);\n// CONCATENATED MODULE: ./src/index.js\nreact_dom_default.a.render(/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(src_App_0,{}),document.getElementById('root'));\n\n/***/ })\n\n},[[54,1,2]]]);","inputSourceMap":{"version":3,"sources":["/Users/yangxu/newappcopy/node_modules/mini-css-extract-plugin/dist/loader.js??ref--5-oneOf-4-0!/Users/yangxu/newappcopy/node_modules/css-loader/dist/cjs.js??ref--5-oneOf-4-1!/Users/yangxu/newappcopy/node_modules/postcss-loader/src/index.js??postcss!/Users/yangxu/newappcopy/src/index.css","/Users/yangxu/newappcopy/node_modules/mini-css-extract-plugin/dist/loader.js??ref--5-oneOf-4-0!/Users/yangxu/newappcopy/node_modules/css-loader/dist/cjs.js??ref--5-oneOf-4-1!/Users/yangxu/newappcopy/node_modules/postcss-loader/src/index.js??postcss!/Users/yangxu/newappcopy/src/App.css","/Users/yangxu/newappcopy/node_modules/mini-css-extract-plugin/dist/loader.js??ref--5-oneOf-4-0!/Users/yangxu/newappcopy/node_modules/css-loader/dist/cjs.js??ref--5-oneOf-4-1!/Users/yangxu/newappcopy/node_modules/postcss-loader/src/index.js??postcss!/Users/yangxu/newappcopy/src/MyComponent.css","/Users/yangxu/newappcopy/src/Utils.js","/Users/yangxu/newappcopy/src/MyComponent.js","/Users/yangxu/newappcopy/src/test/CreateZone.js","/Users/yangxu/newappcopy/src/test/Zone.js","/Users/yangxu/newappcopy/src/test/Zones.js","/Users/yangxu/newappcopy/src/App.js","/Users/yangxu/newappcopy/src/index.js"],"names":["Utils","cv","console","log","self","createFileFromUrl","path","url","callback","request","XMLHttpRequest","open","responseType","onload","ev","readyState","status","data","Uint8Array","response","FS_createDataFile","printError","send","OPENCV_URL","loadOpenCv","onloadCallback","script","document","createElement","setAttribute","addEventListener","getBuildInformation","Promise","src","node","getElementsByTagName","parentNode","insertBefore","MyComponent","useOpenCv","loaded","useState","videoLoaded","setVideoLoaded","useEffect","openCvReady","catchZoomWindow","navigator","mediaDevices","getDisplayMedia","video","audio","then","stream","getElementById","add_button","zoom_window_text","process_window_text","output","srcObject","settings","getVideoTracks","getSettings","style","display","width","height","play","catch","err","Mat","utils","FPS","CV_8UC4","dst","CV_8UC1","gray","cap","VideoCapture","faces","RectVector","classifier","CascadeClassifier","minsize","Size","maxsize","faceCascadeFile","clip_width","clip_height","load","captureImageFromVideo","canvas","getContext","drawImage","base64Canvas","toDataURL","split","getFaceFromFaceplusplus","post_img","formData","FormData","append","fetch","method","mode","body","json","processVideo","begin","Date","now","read","copyTo","cvtColor","COLOR_RGBA2GRAY","detectMultiScale","i","size","face","get","face_row","parseInt","y","face_col","x","tmp_row","tmp_col","point1","Point","point2","rectangle","imshow","delay","setTimeout","CreateZone","props","state","zone","name","zipCode","event","updated","Object","assign","target","id","value","setState","JSON","stringify","onCreate","updateZone","bind","submitZone","Component","Zone","currentZone","zipCodes","numComments","Zones","list","updatedZone","listItems","map","addZone","LoadOpenCv","cv_status","window","fontSize","App","browserName","browserVersion","alert","onLoaded","ReactDOM","render"],"mappings":"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","file":"x","sourcesContent":["// extracted by mini-css-extract-plugin","// extracted by mini-css-extract-plugin","// extracted by mini-css-extract-plugin","import { OpenCvProvider, useOpenCv } from 'opencv-react'\nimport {React, useCallback, useEffect} from 'react'\n\nfunction Utils(cv) {\n\n    // const { loaded, cv } = useOpenCv();\n\n    // useEffect(() => {\n    //     if (cv) {\n    //         console.log('utils useEffect', cv);\n    //     }\n    // }, [cv])\n\n    console.log('utils:', cv);\n\n    let self = this;\n    this.createFileFromUrl = function(path, url, callback) {\n        let request = new XMLHttpRequest();\n        request.open('GET', url, true);\n        request.responseType = 'arraybuffer';\n        request.onload = function(ev) {\n            if (request.readyState === 4) {\n                if (request.status === 200) {\n                    let data = new Uint8Array(request.response);\n                    cv.FS_createDataFile('/', path, data, true, false, false);\n                    callback();\n\n                } \n                else {\n                    self.printError('Failed to load ' + url + ' status: ' + request.status);\n                    return;\n                }\n            }\n        };\n        request.send();\n    };\n\n    const OPENCV_URL = './opencv/opencv.js';\n    this.loadOpenCv = function(onloadCallback) {\n        let script = document.createElement('script');\n        script.setAttribute('async', '');\n        script.setAttribute('type', 'text/javascript');\n        script.addEventListener('load', async () => {\n            if (cv.getBuildInformation)\n            {\n                console.log(cv.getBuildInformation());\n                onloadCallback();\n            }\n            else\n            {\n                // WASM\n                if (cv instanceof Promise) {\n                    cv = await cv;\n                    console.log(cv.getBuildInformation());\n                    onloadCallback();\n                } else {\n                    cv['onRuntimeInitialized']=()=>{\n                        console.log(cv.getBuildInformation()); \n                        onloadCallback();\n                    }\n                }\n            }\n        });\n        script.addEventListener('error', () => {\n            self.printError('Failed to load ' + OPENCV_URL);\n        });\n        script.src = OPENCV_URL;\n        let node = document.getElementsByTagName('script')[0];\n        node.parentNode.insertBefore(script, node);\n    };\n}\n\nexport default Utils;","import { OpenCvProvider, useOpenCv } from 'opencv-react'\nimport {useEffect, useState} from 'react'\nimport './MyComponent.css';\nimport Utils from './Utils';\nimport axios from 'axios';\n\nfunction MyComponent() {\n\n    const { loaded, cv } = useOpenCv();\n    const [videoLoaded, setVideoLoaded] = useState(false);\n\n\n    useEffect(() => {\n        console.log(loaded, cv);\n        if (loaded) {\n            console.log('component cv loaded');\n            if(videoLoaded){\n                console.log('video loaded');\n\n                openCvReady();\n            }\n        }\n    }, [loaded, videoLoaded])\n\n    // const [count, setCount] = useState(0);\n\n    const catchZoomWindow = () => {\n        navigator.mediaDevices.getDisplayMedia({ video: true, audio: false })\n        .then(function(stream) {\n            var video = document.getElementById(\"cam_input\");\n            var add_button = document.getElementById(\"add\");\n            var zoom_window_text = document.getElementById(\"zoom_window_text\");\n            var process_window_text = document.getElementById(\"process_window_text\");\n            var output = document.getElementById(\"canvas_output\");\n            // console.log(video);\n            // console.log(stream);\n            video.srcObject = stream;\n            console.log(stream);\n            let settings = stream.getVideoTracks()[0].getSettings();\n            console.log(settings);\n            add_button.style.display = \"none\";\n            zoom_window_text.style.display = \"none\";\n            process_window_text.style.display = \"none\";\n            // FPS = settings.frameRate;\n            output.style.width = video.style.width;\n            output.style.height = video.style.height;\n            video.play();\n        })\n        .then(()=> {\n            // openCvReady();\n            // utils.loadOpenCv(openCvReady);\n            setVideoLoaded(true);\n            \n        })\n        .catch((err) =>{\n            console.log(\"An error occurred! \" + err);\n        });\n\n    }\n\n    function openCvReady() {\n        // const { loaded, cv } = useOpenCv();\n        \n        console.log('opencvReady', cv.Mat, loaded);\n        let utils = new Utils(cv);\n\n\n    \n        let FPS = 0.25;\n        let video = document.getElementById(\"cam_input\");\n        let src = new cv.Mat(video.height, video.width, cv.CV_8UC4);\n        let dst = new cv.Mat(video.height, video.width, cv.CV_8UC1);\n        let gray = new cv.Mat();\n        let cap = new cv.VideoCapture(video);\n        let faces = new cv.RectVector();\n        let classifier = new cv.CascadeClassifier();\n        let minsize = new cv.Size(0, 0);\n        let maxsize = new cv.Size(1000, 1000);\n        let faceCascadeFile = \"haarcascade_frontalface_default.xml\";\n        let clip_width = video.width/5;\n        let clip_height = video.height/5;\n\n        console.log('cvReady classifier', classifier);\n        \n        console.log('here');\n\n        utils.createFileFromUrl(faceCascadeFile, faceCascadeFile, ()=>{\n            classifier.load(faceCascadeFile);\n        });\n\n        \n        // utils.createFileFromUrl(faceCascadeFile, faceCascadeFile, () => {\n        //     console.log('here2');\n        //     classifier.load(faceCascadeFile) // in the callback, load the cascade from file\n        //     .then(()=>{\n        //         console.log('AAA'); \n        //         processVideo();\n        //     })\n        //     .catch((err)=>{console.log('load classifier:', err)});\n            \n        // });\n\n    \n        // let face_row = -1;\n        // let face_col = -1;\n    \n        // while(true){\n        //     let begin = Date.now();\n            \n        //     cap.read(src);\n        //     src.copyTo(dst);\n        //     cv.cvtColor(dst, gray, cv.COLOR_RGBA2GRAY, 0);\n        //     console.log('process classifier:', classifier);\n        //     // console.log(classifier.load);\n        //     // console.log(gray);\n        //     // console.log(faces);\n            \n\n        //     try{\n        //         classifier.detectMultiScale(gray, faces, 1.1, 3);\n\n        //     }catch(err){\n        //         console.log(err);\n        //     }\n    \n        // }\n\n        function captureImageFromVideo() {\n            var canvas = document.createElement('canvas');\n            canvas.width = video.width * 0.5;\n            canvas.height = video.height * 0.5;\n            canvas.getContext(\"2d\").drawImage(video, 0, 0, canvas.width, canvas.height);\n            // var img = document.createElement('img');\n            var base64Canvas = canvas.toDataURL('image/ipeg').split(';base64,')[1];\n            return base64Canvas;\n            \n        }\n\n        async function getFaceFromFaceplusplus() {\n            var post_img = captureImageFromVideo();\n            let formData = new FormData();\n            formData.append('api_key', 'ZK0tSZ-34wMRkeWaCivkN4Ty5MFV4a9j');\n            formData.append('api_secret', 'Kqt6dM83UsEoudBS0egUgYPIt_WOFFhQ');\n            formData.append('image_base64', post_img);\n\n            let response = await fetch('https://api-cn.faceplusplus.com/facepp/v3/detect', {\n                method: 'post',\n                mode: 'no-cors',\n                body: formData\n            });\n\n            // let data = await JSON.parse({\"request_id\": \"1636947607,16ad0124-2bfb-436d-9636-de57d16e23c9\",\"time_used\": 519});\n            // let tmp_response ='{\"request_id\": \"1636947607,16ad0124-2bfb-436d-9636-de57d16e23c9\",\"time_used\": 519}';\n            \n            let data = response.json();\n            return data;\n        }\n\n        function processVideo() {\n            let begin = Date.now();\n            if (video.srcObject!=null){\n                cap.read(src);\n                src.copyTo(dst);\n                cv.cvtColor(dst, gray, cv.COLOR_RGBA2GRAY, 0);\n                // console.log('process classifier:', classifier);\n\n\n                var post_img = captureImageFromVideo();\n                let formData = new FormData();\n                formData.append('api_key', 'ZK0tSZ-34wMRkeWaCivkN4Ty5MFV4a9j');\n                formData.append('api_secret', 'Kqt6dM83UsEoudBS0egUgYPIt_WOFFhQ');\n                formData.append('image_base64', post_img);\n\n                // console.log(post_img);\n\n                \n                // axios.post('https://api-cn.faceplusplus.com/facepp/v3/detect', {\n                //     // headers: {\n                //     //     'Access-Control-Allow-Origin': '*',\n                //     // },\n                //     mode: 'no-cors',\n                //     body: formData\n                // }).then(function (response) {\n                //     console.log(response);\n                // })\n                // .catch(function (error) {\n                // console.log(error);\n                // });\n\n                // fetch('https://api-cn.faceplusplus.com/facepp/v3/detect', {\n                //     method: 'post',\n                //     mode: 'no-cors',\n                //     body: formData\n                // })\n                // // .then(res => res.json())\n                // .then(res => {\n                //     console.log(typeof(res));\n                //     console.log(res);\n                //     console.log(res.json());\n                // })\n                // .catch(function(err) {\n                //     console.log('fetch err:', err);\n                // });\n                \n\n                // let data = getFaceFromFaceplusplus();\n                // console.log('data:', data);\n\n\n                // var http = new XMLHttpRequest();\n                // var url = 'https://api-cn.faceplusplus.com/facepp/v3/detect';\n\n                // http.open('POST', url, true);\n                // http.setRequestHeader('Access-Control-Allow-Origin','*');\n\n                // http.onload = function() {//Call a function when the state changes.\n                //     if(http.readyState == 4 && http.status == 200) {\n                //         console.log(http.responseText);\n                //     }\n                //     else {\n                //         console.log('Failed to load ' + url + ' status: ' + http.status);\n                //     }\n                // }\n                // http.send(formData);\n\n                // error Message location\n                // classifier.detectMultiScale(gray, faces, 1.1, 3);\n    \n                try{\n                    classifier.detectMultiScale(gray, faces, 1.1, 3);\n                }catch(err){\n                    console.log(err);\n                }\n\n                for (let i = 0; i < faces.size(); ++i) {\n                    let face = faces.get(i);\n                    // console.log(face);\n                    let face_row = parseInt(face.y/clip_height);\n                    let face_col = parseInt(face.x/clip_width);\n    \n                    let tmp_row = parseInt((face.y+face.height-5) / clip_height);\n                    let tmp_col = parseInt((face.x+face.width-5) / clip_width);\n                    // console.log([face_row, face_col, tmp_row, tmp_col]);\n                    if (face.width>=clip_width || face.height>=clip_height || tmp_row!=face_row || tmp_col!=face_col)\n                        continue;\n    \n                    let point1 = new cv.Point(face.x, face.y);\n                    let point2 = new cv.Point(face.x + face.width, face.y + face.height);\n                    cv.rectangle(dst, point1, point2, [255, 0, 0, 255]);\n                }\n                cv.imshow(\"canvas_output\", dst);\n            }\n            // schedule next one.\n            let delay = 1000/FPS - (Date.now() - begin);\n            setTimeout(processVideo, delay);\n        }\n        // schedule first one.\n        setTimeout(processVideo, 0);\n        \n    }\n\n\n    // const cv = useOpenCv()\n    // console.log(cv)\n\n    // const video = document.getElementById(\"video\");\n    // let src = new cv.Mat(video.height, video.width, cv.CV_8UC4);\n    // let dst = new cv.Mat(video.height, video.width, cv.CV_8UC1);\n    // let gray = new cv.Mat();\n    // let cap = new cv.VideoCapture(video);\n    // let faces = new cv.RectVector();\n    // let classifier = new cv.CascadeClassifier();\n\n    // let faceCascadeFile = 'haarcascade_frontalface_default.xml'; // path to xml\n    // classifier.load(faceCascadeFile);\n    // console.log(classifier);\n\n    // function onOpenUtilsReady() {\n    //     let utils = new Utils('errorMessage');\n    //     utils.loadOpenCv(() => {\n    //     let faceCascadeFile = 'haarcascade_frontalface_default.xml';\n    //         utils.createFileFromUrl(faceCascadeFile, faceCascadeFile, () => {\n    //             document.getElementById('status').innerHTML = 'OpenCV.js is ready.';\n    //         });\n    //     });\n    // }\n\n    return (\n        <>\n        <div className=\"container\">\n            <h2 id=\"title\">iExam</h2>\n            <h6 id=\"tip\">Please click add button to import the Zoom stream. Then you can scroll down to the iExam window.</h6>\n            <p id=\"zoom_window_text\">Zoom window</p>\n            <video id=\"cam_input\" width=\"1200\" height=\"690\" autoPlay muted></video>\n            {/* <img id=\"add\" src=\"add.svg\" alt=\"upload video window\" width=\"128\" height=\"128\" /> */}\n            <svg xmlns=\"http://www.w3.org/2000/svg\" id=\"add\" onClick={catchZoomWindow} width=\"120\" height=\"120\" viewBox=\"0 0 24 24\"><path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z\"/></svg>\n            <p id=\"process_window_text\">iExam window</p>\n            <canvas id=\"canvas_output\" width=\"1200\" height=\"690\">This box is for capturing student face</canvas>\n        </div>\n        <div className=\"footer\">\n            <p>Details for iExam please refer to slides: <a href=\"https://daoyuan14.github.io/slides/Expo21_iExam.pdf\" target=\"_blank\">https://daoyuan14.github.io/slides/Expo21_iExam.pdf</a></p>\n            <p>Post-exam recording analysis for desktop version, please view: <a href=\"https://github.com/VPRLab/iExam/tree/test\" target=\"_blank\">https://github.com/VPRLab/iExam/tree/test </a></p>\n            {/* <p id=\"author\">Author: YANG Xu, Supervisor: WU Daoyuan (VPRLab)</p>\n            <p>Last Modified: Mon Oct 25 2021 23:12:29 GMT+0800 (Hong Kong Standard Time)</p> */}\n        </div>\n        </>\n        \n    )\n}\n\n// function Utils() {\n//     let self = this;\n//     this.createFileFromUrl = function(path, url, callback) {\n//         console.log(cv);\n//         let request = new XMLHttpRequest();\n//         request.open('GET', url, true);\n//         request.responseType = 'arraybuffer';\n//         request.onload = function(ev) {\n//             if (request.readyState === 4) {\n//                 if (request.status === 200) {\n//                     let data = new Uint8Array(request.response);\n//                     cv.FS_createDataFile('/', path, data, true, false, false);\n//                     callback();\n//                 } else {\n//                     self.printError('Failed to load ' + url + ' status: ' + request.status);\n//                 }\n//             }\n//         };\n//         request.send();\n        \n//     };\n\n//     const OPENCV_URL = './opencv/opencv.js';\n//     this.loadOpenCv = function(onloadCallback) {\n//         let script = document.createElement('script');\n//         script.setAttribute('async', '');\n//         script.setAttribute('type', 'text/javascript');\n//         script.addEventListener('load', async () => {\n//             if (cv.getBuildInformation)\n//             {\n//                 console.log(cv.getBuildInformation());\n//                 onloadCallback();\n//             }\n//             else\n//             {\n//                 // WASM\n//                 if (cv instanceof Promise) {\n//                     cv = await cv;\n//                     console.log(cv.getBuildInformation());\n//                     onloadCallback();\n//                 } else {\n//                     cv['onRuntimeInitialized']=()=>{  //satisfy this condition\n//                         console.log(cv.getBuildInformation()); \n//                         onloadCallback();\n//                     }\n//                 }\n//             }\n//         });\n//         script.addEventListener('error', () => {\n//             self.printError('Failed to load ' + OPENCV_URL);\n//         });\n//         script.src = OPENCV_URL;\n//         let node = document.getElementsByTagName('script')[0];\n//         node.parentNode.insertBefore(script, node);\n//     };\n// }\n\n\n\nexport default MyComponent;\n\n\n","import React, { Component } from \"react\";\n\nexport default class CreateZone extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      zone: {\n        name: \"\",\n        zipCode: \"\",\n      },\n    };\n  }\n\n  updateZone(event) {\n    let updated = Object.assign({}, this.state.zone);\n    updated[event.target.id] = event.target.value;\n    this.setState({\n      zone: updated,\n    });\n  }\n\n  submitZone(event) {\n    console.log(\"SubmitZone: \" + JSON.stringify(this.state.zone));\n    this.props.onCreate(this.state.zone);\n  }\n\n  render() {\n    return (\n      <div>\n        <input\n          onChange={this.updateZone.bind(this)}\n          className=\"form-control\"\n          id=\"name\"\n          type=\"text\"\n          placeholder=\"Name\"\n        />{\" \"}\n        <br />\n        <input\n          onChange={this.updateZone.bind(this)}\n          className=\"form-control\"\n          id=\"zipCode\"\n          type=\"text\"\n          placeholder=\"Zip Code\"\n        />{\" \"}\n        <br />\n        <input\n          onClick={this.submitZone.bind(this)}\n          className=\"btn btn-danger\"\n          type=\"submit\"\n          value=\"Submit Zone\"\n        />\n      </div>\n    );\n  }\n}","import React, { Component } from \"react\";\n\nexport default class Zone extends Component {\n  render() {\n\n    return (\n      <div >\n        <h2 >\n          <a href=\"#\">\n            {\" \"}\n            {this.props.currentZone.name}{\" \"}\n          </a>\n        </h2>\n        <span className=\"detail\"> {this.props.currentZone.zipCodes} </span>{\" \"}\n        <br />\n        <span className=\"detail\">\n          {\" \"}\n          {this.props.currentZone.numComments} comments{\" \"}\n        </span>\n      </div>\n    );\n  }\n}","import React, { Component } from \"react\";\n// import superagent from \"superagent\";\nimport CreateZone from \"./CreateZone\";\nimport Zone from \"./Zone\";\n\nexport default class Zones extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      list: [],\n    };\n  }\n\n  componentDidMount() {\n    console.log(\"componentDidMount\");\n    // superagent\n    //   .get(\"/api/zone\")\n    //   .query(null)\n    //   .set(\"Accept\", \"application/json\")\n    //   .end((err, response) => {\n    //     if (err) {\n    //       alert(\"ERROR: \" + err);\n    //       return;\n    //     }\n    //     console.log(JSON.stringify(response.body));\n    //     let results = response.body.results;\n    //     this.setState({\n    //       list: results,\n    //     });\n    //   });\n  }\n\n  addZone(zone) {\n    let updatedZone = Object.assign({}, zone);\n    updatedZone[\"zipCodes\"] = updatedZone.zipCode.split(\",\");\n    console.log(\"ADD ZONE: \" + JSON.stringify(updatedZone));\n\n    // superagent\n    //   .post(\"/api/zone\")\n    //   .send(updatedZone)\n    //   .set(\"Accept\", \"application/json\")\n    //   .end((err, response) => {\n    //     if (err) {\n    //       alert(\"ERROR: \" + err.message);\n    //       return;\n    //     }\n    //     console.log(\"ZONE CREATED: \" + JSON.stringify(response));\n    //     let updatedList = Object.assign([], this.state.list);\n    //     updatedList.push(response.result);\n    //     this.setState({\n    //       list: updatedList,\n    //     });\n    //   });\n  }\n\n  render() {\n    const listItems = this.state.list.map((zone, i) => {\n      return (\n        <li key={i}>\n          {\" \"}\n          <Zone currentZone={zone} />{\" \"}\n        </li>\n      );\n    });\n\n    return (\n      <div>\n        <ol>{listItems}</ol>\n        <CreateZone onCreate={this.addZone.bind(this)} />\n      </div>\n    );\n  }\n}","import './App.css';\nimport {React, useEffect} from 'react';\nimport { browserName, browserVersion } from \"react-device-detect\";\nimport MyComponent from './MyComponent'\n// import Utils from './Utils';\n\nimport CreateZone from './test/CreateZone'\nimport Zones from './test/Zones';\nimport Zone from './test/Zone';\n\nimport { OpenCvProvider, useOpenCv } from 'opencv-react'\n\n\n\nfunction LoadOpenCv() {\n\n  const { loaded, cv } = useOpenCv()\n  const cv_status = document.getElementById(\"status\");\n\n  useEffect(() => {\n    console.log(loaded, cv);\n    console.log(window.cv);\n    if (loaded) {\n      cv_status.style.display = \"none\";\n    }\n  }, [loaded])\n  if (loaded)\n    return(<MyComponent />)\n  else\n    return (<p id=\"status\" style={{display: 'block'}, {fontSize: 20}}>OpenCV.js is loading...</p>)\n}\n\nconst App = () => {\n\n  useEffect(()=>{\n    console.log(`${browserName} ${browserVersion}`);\n    console.log(typeof(browserName));\n    console.log(browserName);\n    if (browserName == 'Safari'){\n      console.log(\"yes\");\n      while(true)\n        alert(\"You use Safari now, please change another browser because Safari not support capture window function\");\n    }\n  })\n\n  const onLoaded = () => {\n    console.log('opencv loaded, cv')\n  }\n    \n  return (\n    <div> \n    <OpenCvProvider>\n      <LoadOpenCv />\n      {/* <MyComponent /> */}\n      {/* <CreateZone /> */}\n      {/* <Zones /> */}\n    </OpenCvProvider>\n    </div>\n  )\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n    <App />,\n  document.getElementById('root')\n);\n"]}}