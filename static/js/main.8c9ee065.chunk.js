(this.webpackJsonpnewappcopy=this.webpackJsonpnewappcopy||[]).push([[0],{28:function(e,t,n){},29:function(e,t,n){},33:function(e,t,n){},54:function(e,t,n){"use strict";n.r(t);var o=n(1),a=n(22),i=n.n(a),s=(n(28),n(29),n(9)),c=n(8),r=n.n(c),d=n(12),l=n(23),u=n(3);n(33);var h=function(e){console.log("utils:",e);var t=this;this.createFileFromUrl=function(n,o,a){var i=new XMLHttpRequest;i.open("GET",o,!0),i.responseType="arraybuffer",i.onload=function(s){if(4===i.readyState){if(200!==i.status)return void t.printError("Failed to load "+o+" status: "+i.status);var c=new Uint8Array(i.response);e.FS_createDataFile("/",n,c,!0,!1,!1),a()}},i.send()};var n="./opencv/opencv.js";this.loadOpenCv=function(o){var a=document.createElement("script");a.setAttribute("async",""),a.setAttribute("type","text/javascript"),a.addEventListener("load",Object(d.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.getBuildInformation){t.next=5;break}console.log(e.getBuildInformation()),o(),t.next=14;break;case 5:if(!(e instanceof Promise)){t.next=13;break}return t.next=8,e;case 8:e=t.sent,console.log(e.getBuildInformation()),o(),t.next=14;break;case 13:e.onRuntimeInitialized=function(){console.log(e.getBuildInformation()),o()};case 14:case"end":return t.stop()}}),t)})))),a.addEventListener("error",(function(){t.printError("Failed to load "+n)})),a.src=n;var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(a,i)}},p=(n(34),n(0));var m=function(){var e=Object(u.b)(),t=e.loaded,n=e.cv,a=Object(o.useState)(!1),i=Object(l.a)(a,2),s=i[0],c=i[1];return Object(o.useEffect)((function(){console.log(t,n),t&&(console.log("component cv loaded"),s&&(console.log("video loaded"),function(){console.log("opencvReady",n.Mat,t);var e=new h(n),o=.25,a=document.getElementById("cam_input"),i=new n.Mat(a.height,a.width,n.CV_8UC4),s=new n.Mat(a.height,a.width,n.CV_8UC1),c=new n.Mat,r=new n.VideoCapture(a),d=new n.RectVector,l=new n.CascadeClassifier,u=(new n.Size(0,0),new n.Size(1e3,1e3),"haarcascade_frontalface_default.xml"),p=a.width/5,m=a.height/5;function b(){var e=document.createElement("canvas");return e.width=.5*a.width,e.height=.5*a.height,e.getContext("2d").drawImage(a,0,0,e.width,e.height),e.toDataURL("image/ipeg").split(";base64,")[1]}function j(){var e=Date.now();if(null!=a.srcObject){r.read(i),i.copyTo(s),n.cvtColor(s,c,n.COLOR_RGBA2GRAY,0);var t=b(),u=new FormData;u.append("api_key","ZK0tSZ-34wMRkeWaCivkN4Ty5MFV4a9j"),u.append("api_secret","Kqt6dM83UsEoudBS0egUgYPIt_WOFFhQ"),u.append("image_base64",t);try{l.detectMultiScale(c,d,1.1,3)}catch(_){console.log(_)}for(var h=0;h<d.size();++h){var g=d.get(h),f=parseInt(g.y/m),v=parseInt(g.x/p),w=parseInt((g.y+g.height-5)/m),x=parseInt((g.x+g.width-5)/p);if(!(g.width>=p||g.height>=m||w!=f||x!=v)){var y=new n.Point(g.x,g.y),O=new n.Point(g.x+g.width,g.y+g.height);n.rectangle(s,y,O,[255,0,0,255])}}n.imshow("canvas_output",s)}var E=1e3/o-(Date.now()-e);setTimeout(j,E)}console.log("cvReady classifier",l),console.log("here"),e.createFileFromUrl(u,u,(function(){l.load(u)})),setTimeout(j,0)}()))}),[t,s]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("div",{className:"container",children:[Object(p.jsx)("h2",{id:"title",children:"iExam"}),Object(p.jsx)("h6",{id:"tip",children:"Please click add button to import the Zoom stream. Then you can scroll down to the iExam window."}),Object(p.jsx)("p",{id:"zoom_window_text",children:"Zoom window"}),Object(p.jsx)("video",{id:"cam_input",width:"1200",height:"690",autoPlay:!0,muted:!0}),Object(p.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",id:"add",onClick:function(){navigator.mediaDevices.getDisplayMedia({video:!0,audio:!1}).then((function(e){var t=document.getElementById("cam_input"),n=document.getElementById("add"),o=document.getElementById("zoom_window_text"),a=document.getElementById("process_window_text"),i=document.getElementById("canvas_output");t.srcObject=e,console.log(e);var s=e.getVideoTracks()[0].getSettings();console.log(s),n.style.display="none",o.style.display="none",a.style.display="none",i.style.width=t.style.width,i.style.height=t.style.height,t.play()})).then((function(){c(!0)})).catch((function(e){console.log("An error occurred! "+e)}))},width:"120",height:"120",viewBox:"0 0 24 24",children:Object(p.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"})}),Object(p.jsx)("p",{id:"process_window_text",children:"iExam window"}),Object(p.jsx)("canvas",{id:"canvas_output",width:"1200",height:"690",children:"This box is for capturing student face"})]}),Object(p.jsxs)("div",{className:"footer",children:[Object(p.jsxs)("p",{children:["Details for iExam please refer to slides: ",Object(p.jsx)("a",{href:"https://daoyuan14.github.io/slides/Expo21_iExam.pdf",target:"_blank",children:"https://daoyuan14.github.io/slides/Expo21_iExam.pdf"})]}),Object(p.jsxs)("p",{children:["Post-exam recording analysis for desktop version, please view: ",Object(p.jsx)("a",{href:"https://github.com/VPRLab/iExam/tree/test",target:"_blank",children:"https://github.com/VPRLab/iExam/tree/test "})]})]})]})},b=n(4),j=n(5),g=n(7),f=n(6),v=function(e){Object(g.a)(n,e);var t=Object(f.a)(n);function n(e){var o;return Object(b.a)(this,n),(o=t.call(this,e)).state={zone:{name:"",zipCode:""}},o}return Object(j.a)(n,[{key:"updateZone",value:function(e){var t=Object.assign({},this.state.zone);t[e.target.id]=e.target.value,this.setState({zone:t})}},{key:"submitZone",value:function(e){console.log("SubmitZone: "+JSON.stringify(this.state.zone)),this.props.onCreate(this.state.zone)}},{key:"render",value:function(){return Object(p.jsxs)("div",{children:[Object(p.jsx)("input",{onChange:this.updateZone.bind(this),className:"form-control",id:"name",type:"text",placeholder:"Name"})," ",Object(p.jsx)("br",{}),Object(p.jsx)("input",{onChange:this.updateZone.bind(this),className:"form-control",id:"zipCode",type:"text",placeholder:"Zip Code"})," ",Object(p.jsx)("br",{}),Object(p.jsx)("input",{onClick:this.submitZone.bind(this),className:"btn btn-danger",type:"submit",value:"Submit Zone"})]})}}]),n}(o.Component),w=function(e){Object(g.a)(n,e);var t=Object(f.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(j.a)(n,[{key:"render",value:function(){return Object(p.jsxs)("div",{children:[Object(p.jsx)("h2",{children:Object(p.jsxs)("a",{href:"#",children:[" ",this.props.currentZone.name," "]})}),Object(p.jsxs)("span",{className:"detail",children:[" ",this.props.currentZone.zipCodes," "]})," ",Object(p.jsx)("br",{}),Object(p.jsxs)("span",{className:"detail",children:[" ",this.props.currentZone.numComments," comments"," "]})]})}}]),n}(o.Component);o.Component;function x(){var e=Object(u.b)(),t=e.loaded,n=e.cv,a=document.getElementById("status");return Object(o.useEffect)((function(){console.log(t,n),console.log(window.cv),t&&(a.style.display="none")}),[t]),t?Object(p.jsx)(m,{}):Object(p.jsx)("p",{id:"status",style:{fontSize:20},children:"OpenCV.js is loading..."})}var y=function(){Object(o.useEffect)((function(){if(console.log("".concat(s.browserName," ").concat(s.browserVersion)),console.log(typeof s.browserName),console.log(s.browserName),"Safari"==s.browserName)for(console.log("yes");;)alert("You use Safari now, please change another browser because Safari not support capture window function")}));return Object(p.jsx)("div",{children:Object(p.jsx)(u.a,{children:Object(p.jsx)(x,{})})})};i.a.render(Object(p.jsx)(y,{}),document.getElementById("root"))}},[[54,1,2]]]);
//# sourceMappingURL=main.8c9ee065.chunk.js.map